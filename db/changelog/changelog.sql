-- liquibase formatted sql

-- changeset jan:1694936265955-1
CREATE TABLE "tickets" ("id" BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL, "meetup_id" BIGINT NOT NULL, "user_id" BIGINT NOT NULL, "is_checked_in" BOOLEAN DEFAULT FALSE, "raffle_entries" INTEGER DEFAULT 0, "raffle_wins" INTEGER DEFAULT 0, CONSTRAINT "tickets_pkey" PRIMARY KEY ("id"));
CREATE TABLE "users" ("id" BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL, "email" VARCHAR(100) NOT NULL, "first_name" VARCHAR(30), "last_name" VARCHAR(30), "nick_name" VARCHAR(30), "is_organizer" BOOLEAN DEFAULT FALSE, "is_admin" BOOLEAN DEFAULT FALSE, CONSTRAINT "users_pkey" PRIMARY KEY ("id"));
CREATE TABLE "meetups" ("id" INTEGER GENERATED BY DEFAULT AS IDENTITY NOT NULL, "name" VARCHAR(100) NOT NULL, "date" date NOT NULL, "organizer_ids" INT8[], "has_raffle" BOOLEAN DEFAULT FALSE, CONSTRAINT "meetups_pkey" PRIMARY KEY ("id"));
CREATE SEQUENCE  IF NOT EXISTS "meetups_id_seq" AS bigint START WITH 1 INCREMENT BY 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1;
CREATE SEQUENCE  IF NOT EXISTS "tickets_id_seq" AS bigint START WITH 1 INCREMENT BY 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1;
CREATE SEQUENCE  IF NOT EXISTS "users_id_seq" AS bigint START WITH 1 INCREMENT BY 1 MINVALUE 1 MAXVALUE 9223372036854775807 CACHE 1;
ALTER TABLE "users" ADD CONSTRAINT "email_unique" UNIQUE ("email");
ALTER TABLE "tickets" ADD CONSTRAINT "meetup_id_fkey" FOREIGN KEY ("meetup_id") REFERENCES "meetups" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION;
ALTER TABLE "tickets" ADD CONSTRAINT "user_id_fkey" FOREIGN KEY ("user_id") REFERENCES "users" ("id") ON UPDATE NO ACTION ON DELETE NO ACTION;

-- changeset jan:2
ALTER TABLE "meetups" ALTER COLUMN "id" TYPE BIGINT;
